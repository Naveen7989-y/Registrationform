"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[38],{4056:function(e,t,n){n.d(t,{a:function(){return s},b:function(){return d}});var a=n(6334),i=n(1932),r=n(8838),o=n("odsp.util_517").x9.isActivated("686714b6-ee9c-44e7-9cc2-1fbe75a88eac"),s={ID:"",displayName:r.b,realFieldName:"File size",internalName:"FileSizeDisplay",type:i.a.FileSize,width:150,isCalculated:!0,isReadOnly:!0,isSortable:!0,isEditable:!1,rawFieldData:{FieldType:"FileSize",Name:"FileSizeDisplay",Groupable:"FALSE"}},c={ID:"",displayName:r.a,realFieldName:"Activity",internalName:"FileActivity",type:i.a.FileActivity,width:445,isCalculated:!0,isSortable:!1,isReadOnly:!0,isEditable:!1};function d(e,t){var n=[],i=null;if((0,a.a)(t)){for(var r=0,d=e;r<d.length;r++){var l=d[r];"SharedWith"===l.internalName?i=l:n.push(l)}return o&&n.push(s),i&&n.push(i),n.push(c),n}return e}}
,5076:function(e,t,n){n.d(t,{a:function(){return i}});var a=n("odsp.util_517").x9.isActivated("43c21516-7a9e-4d81-ba4e-373de20859b8");function i(e){var t,n,i={};if((null===(t=null==e?void 0:e.schema)||void 0===t?void 0:t.aggregate)&&((null===(n=null==e?void 0:e.items)||void 0===n?void 0:n.length)>0||!a))for(var o=e.schema.aggregate,s=0,c=Object.keys(o);s<c.length;s++){var d=c[s],l=r(e,d);l&&(i[d]=l)}return Object.keys(i).length>0?i:void 0}function r(e,t){var n,i,r,o,s,c,d;d=a?null===(s=null==e?void 0:e.items)||void 0===s?void 0:s[0]:(null===(n=null==e?void 0:e.items)||void 0===n?void 0:n[0])||(null===(o=null===(r=null===(i=e.rawResponse)||void 0===i?void 0:i.ListData)||void 0===r?void 0:r.Row)||void 0===o?void 0:o[0]);var l=null===(c=null==e?void 0:e.schema)||void 0===c?void 0:c.aggregate;if(d&&l&&t&&l[t]){var u=l[t];return{type:u,value:d[t+"."+u]}}}}
,2553:function(e,t,n){n.d(t,{a:function(){return _},b:function(){return D},c:function(){return y},d:function(){return b},e:function(){return v},f:function(){return g},g:function(){return h}});var a=n("tslib_538"),i=n("odsp.util_517"),r=n(160),o=n(5076);function s(e){if(e&&e.rawResponse){var t=e.rawResponse;return t.AvailableContentTypes||t.ListContenTypes}}var c=n(2847),d=n(404),l=n(6333),u=n(4056),f=n(6334),p=i.x9.isActivated("89dbb277-1823-422d-b50f-1b8f23516afd","05/17/2023","Keep old group collased state on same view"),m=i.x9.isActivated("686714b6-ee9c-44e7-9cc2-1fbe75a88eac"),_=new i.lh({name:"ListDataStateStore.key",factory:{dependencies:{spartanViewInstance:d.a},create:function(){var e,t="init";return{instance:e=new r.a({listStyle:g(t,void 0),listRenderData:b(t,void 0),listSettings:v(t,void 0),commandBarCustomizationInput:y(t,void 0),pinnedItemData:h(t,void 0)}),disposable:e}}}});function h(e,t,n,a,i,r){return r?{publisher:e,pinnedItemIds:r}:{publisher:e,pinnedItemIds:(null==t?void 0:t.pinnedItemIds)||(null==n?void 0:n.state.pinnedItemData.pinnedItemIds)}}function b(e,t,n,i,r){var d,_,h,b,g,v,y,S,D=2;t&&t.schema.fields.length>0&&"DocIcon"===t.schema.fields[0].internalName&&D++,t&&t.schema.viewFormatter&&(D-=t.schema.viewFormatter.hideSelection?1:0);var I=s(t)||(null==n?void 0:n.state.listRenderData.availableContentTypes),x=function(e){if(e&&e.rawResponse)return e.rawResponse.FolderContentTypeOrder||s(e)}(t)||(null==n?void 0:n.state.listRenderData.folderContentTypeOrder),C=r||(null===(d=null==n?void 0:n.state)||void 0===d?void 0:d.listRenderData.requestItemKey),O=C&&(0,l.a)(C),w=O?(0,c.c)(O,t,{areGroupsCollapsed:null==t?void 0:t.schema.areAllGroupsCollapsed}):void 0;if(!p){var E=null===(h=null===(_=null==n?void 0:n.state)||void 0===_?void 0:_.listRenderData.itemSet)||void 0===h?void 0:h.collapsedGroupKeysSet,A=null===(v=null===(g=null===(b=null==n?void 0:n.state)||void 0===b?void 0:b.listRenderData.schema)||void 0===g?void 0:g.currentView)||void 0===v?void 0:v.Id;E&&E.size>0&&A===(null===(y=null==t?void 0:t.schema.currentView)||void 0===y?void 0:y.Id)&&w&&(w=(0,a.q5)((0,a.q5)({},w),{collapsedGroupKeysSet:E}))}var L=(null==t?void 0:t.pageContext)||i||(null===(S=null==n?void 0:n.state)||void 0===S?void 0:S.listRenderData.pageContext),k=t&&t.list&&(0,f.a)(t.list),M=null==t?void 0:t.schema;!m&&k&&M&&M.fields&&(M=(0,a.q5)((0,a.q5)({},M),{fields:(0,a.lt)((0,a.lt)([],M.fields,!0),[u.a],!1)}));var P=(null==t?void 0:t.pinnedItemIds)||(null==n?void 0:n.state.listRenderData.pinnedItemIds),T={publisher:e,numStickyColumns:D,requestItemKey:C,itemSet:w,pageContext:L,list:null==t?void 0:t.list,schema:M,seedItems:null==t?void 0:t.items,seedItemsNextPageToken:null==t?void 0:t.nextPage,seedGroups:null==t?void 0:t.groups,viewData:null==t?void 0:t.viewData,views:null==t?void 0:t.views,rawResponse:null==t?void 0:t.rawResponse,availableContentTypes:I,folderContentTypeOrder:x,pinnedItemIds:P},U=(0,o.a)(t);return U&&(T.aggregateData=U),T}function g(e,t){return{publisher:e,icon:null==t?void 0:t.icon,color:null==t?void 0:t.color}}function v(e,t,n){var a,i,r;if(t&&t.rawResponse){var o=(null===(a=null==t?void 0:t.rawResponse)||void 0===a?void 0:a.CustomActions)||(null===(r=null===(i=null==n?void 0:n.state)||void 0===i?void 0:i.listSettings)||void 0===r?void 0:r.customActions)||[];return{publisher:e,allowCreateFolder:t.rawResponse.AllowCreateFolder,contentTypeEnabled:t.rawResponse.ContentTypesEnabled,folderContentTypeOrder:t.rawResponse.FolderContentTypeOrder,customActions:o}}return{publisher:e}}function y(e,t){var n=null==t?void 0:t.schema;return{publisher:e,customFormatterSchema:null==n?void 0:n.customFormatterSchema,viewFormatter:null==n?void 0:n.viewFormatter}}var S={listStyle:g,listRenderData:b,listSettings:v,commandBarCustomizationInput:y,pinnedItemData:h},D=new i.lh({name:"ListDataStateStore.key_updater",factory:{dependencies:{listDataStateStore:_},create:function(e){var t=e.listDataStateStore;return{instance:function(e,n,a,i,r,o){for(var s=0,c="All"===n?Object.keys(t.state):n;s<c.length;s++){var d=c[s];t.update(d,S[d](e,a,t,r,o),i)}}}}}})}
,2860:function(e,t,n){n.d(t,{a:function(){return i},b:function(){return o},c:function(){return c},d:function(){return d},e:function(){return r},f:function(){return s}});var a="__placeholderGroup__",i={key:a,name:"Placeholder",itemCount:1,displayCount:1};function r(e){return e.key===a}function o(e){return{ID:e,Editor:[],__placeholder:!0}}function s(e){return!!e.__placeholder}function c(e){return e.ID}function d(e,t){return e[t]&&!s(e[t])}}
,6334:function(e,t,n){n.d(t,{a:function(){return i}});var a=n(63);function i(e){return(null==e?void 0:e.templateType)===a.a.mySiteDocumentLibrary}}
,6333:function(e,t,n){n.d(t,{a:function(){return c}});var a=n("tslib_538"),i=n(1582),r=n(851),o=n(267),s=n(344);function c(e){if(s.a.matches(e)){var t=s.a.deserialize(e);return void 0!==t.rootFolder?o.a.serialize((0,a.q5)((0,a.q5)({},t),{rootFolder:t.rootFolder})):void 0}return r.a.matches(e)?c(r.a.deserialize(e).remoteItemKey):i.a.matches(e)?c(i.a.deserialize(e).currentItemKey):o.a.matches(e)?e:void 0}}
,2847:function(e,t,n){n.d(t,{a:function(){return b},b:function(){return h},c:function(){return g}});var a=n("tslib_538"),i=n(2860),r=n(1771),o=n(267),s=n(1597),c=n(8837),d=n(4017),l=n("odsp.util_517"),u=l.x9.isActivated("371E76C1-A0F2-4CEE-85FC-D06FFC309760"),f=l.x9.isActivated("459ca055-2d3c-4671-a461-a8213619e808"),p=l.x9.isActivated("27a0e276-7f79-43db-bdce-b39667c510e3"),m=l.x9.isActivated("66865304-ea50-4a91-8208-f6de5740be66"),_=l.x9.isActivated("4BB4C4A0-4BC8-4661-A2E4-A1EC782B68BF");function h(e){return void 0!==e.groupings}function b(e){return"group".concat(e)}function g(e,t,n){var s,c,h,b,g,y;void 0===n&&(n={});var S=n.prevItemSet;if(!m&&S&&S.key!==e)throw new l.qt({code:"MakeItemSetKeyDoesNotMatchPrevItemSetKey"});var D=o.a.deserialize(e);if(!t)return(0,a.q5)((0,a.q5)({key:e},D),{items:[],isResolved:!1});var I=n.pageKey,x=n.areGroupsCollapsed,C=t.items,O=t.groups,w=t.rawResponse,E=null===(c=t.currentView)||void 0===c?void 0:c.RowLimit,A=!!((null===(h=null==w?void 0:w.ListSchema)||void 0===h?void 0:h.ItemCount)&&(null===(b=w.ListSchema)||void 0===b?void 0:b.ItemCount)>5e3),L=I&&(null==S?void 0:S.items.findIndex(function(e){return(0,i.f)(e)&&(0,i.c)(e)===I}));if(I&&-1===L)return S||(0,a.q5)((0,a.q5)({key:e},D),{items:[],isResolved:!1});var k,M=void 0!==S?S.areAllGroupsCollapsed:x,P=function(e,t,n){var i,r,s;if(!f&&n)return o.a.deserialize(o.a.serialize(n));var c=null==e?void 0:e.rawResponse,l=(null==c?void 0:c.ListData)||{},p=l.SortField,m=l.SortDir,h=l.FilterLink,b=p||t.sortFieldKey,g="ascending"===m||"descending"!==m&&t.sortAscending;if(!m&&!p){var v=null===(i=null==c?void 0:c.ViewMetadata)||void 0===i?void 0:i.ListViewXml;if(v)try{var y=(0,d.a)(v);if(y&&y.sortFields&&1===y.sortFields.length){var S=y.sortFields[0],D=S.sortField,I=S.sortAsc;D&&void 0!==I&&(b=D,g=!!I)}}catch(e){}}var x=t.filterParams;(h||u)&&"?"!==h&&(x=null==h?void 0:h.substring(1));var C=t.webAbsoluteUrl;return C||_||!(null===(r=null==e?void 0:e.pageContext)||void 0===r?void 0:r.webAbsoluteUrl)||(C=e.pageContext.webAbsoluteUrl),(0,a.q5)((0,a.q5)({},t),{webAbsoluteUrl:C,sortFieldKey:b,sortAscending:g,filterParams:x,groupByFieldKey:(null===(s=null==c?void 0:c.ListSchema)||void 0===s?void 0:s.group1)||t.groupByFieldKey})}(t,D,S),T=(0,a.q5)((0,a.q5)({key:e},P),{rootFolderItem:t.rootFolderItem||(null==S?void 0:S.rootFolderItem),items:(null==S?void 0:S.items.slice(0,(null==S?void 0:S.items.length)-1))||[],groupings:null===(g=null==S?void 0:S.groupings)||void 0===g?void 0:g.slice(0,(null==S?void 0:S.groupings.length)-1),nextPageToken:null==t?void 0:t.nextPage,areAllGroupsCollapsed:M,sortAscending:!f||p||void 0!==P.sortAscending?P.sortAscending:null==S?void 0:S.sortAscending,sortFieldKey:!f||p||void 0!==P.sortFieldKey?P.sortFieldKey:null==S?void 0:S.sortFieldKey,isResolved:!0});return k=(null==S?void 0:S.collapsedGroupKeysSet)?new Set(S.collapsedGroupKeysSet):new Set,O&&O.length>0?T.groupings=v(D,T.items.length,T.groupings,O,T.items,C,0,A,E,void 0,M,k):(s=T.items).push.apply(s,C),T.nextPageToken&&(T.items.push((0,i.b)(r.a.serialize({itemSetKey:D,token:T.nextPageToken}))),null===(y=T.groupings)||void 0===y||y.push(i.a)),T.collapsedGroupKeysSet=k,T}function v(e,t,n,r,o,d,l,u,f,p,m,_){var h=new Map;if(n)for(var g=0,y=n;g<y.length;g++){var S=y[g];h.set(S.key,S)}var D=n||[],I=d.length>0;if(r)for(var x=0;x<r.length;x++){var C=r[x],O=void 0;if(void 0!==(S=h.get(b(C.groupingId)))){var w=0===(P=v(e,t,S.children,C.children,o,d,l+1,u,f,C.groupingId,m,_)).length,E=0,A=C.startIndex||0,L=(x<r.length-1?r[x+1].startIndex:null==d?void 0:d.length)||0;w&&(E=I?S.itemCount+L:1),O=(0,a.q5)((0,a.q5)({},S),{itemCount:E,data:C,children:P,hasMoreData:u&&!!f&&C.count>=f,columnAggregate:C.columnTotals}),D===n&&(D=(0,a.lt)([],n,!0));for(var k=0;k<D.length;k++){var M=D[k];O.key===M.key&&(D[k]=O)}w&&(I?L>0&&o.push.apply(o,d.slice(A,A+L)):o.push((0,i.b)(s.a.serialize({groupId:C.groupingId,itemSetKey:e}))))}else{var P;w=0===(P=v(e,t,void 0,C.children,o,d,l+1,u,f,C.groupingId,m,_)).length,E=0,A=C.startIndex||0,w&&(E=I?Math.min(C.count,d.length-A):1);var T=b(C.groupingId);O={key:T,name:C.name||c.f,itemCount:E,displayCount:C.count,data:C,children:P,hasMoreData:u&&!!f&&C.count>=f,parentKey:p&&b(p),columnAggregate:C.columnTotals},(m||C.isCollapsed)&&(null==_||_.add(T)),w&&(I?E>0&&o.push.apply(o,d.slice(A,A+E)):o.push((0,i.b)(s.a.serialize({groupId:C.groupingId,itemSetKey:e})))),D===n&&(D=(0,a.lt)([],n,!0)),D.push(O)}}return D}}
}]),define("shared-split-bundle~4afa07ba",[],{});