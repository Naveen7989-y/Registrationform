"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([[56],{6271:function(e,t,n){n.d(t,{a:function(){return b}});var a=n("tslib_538"),i=n(1629),r=n(811),o=n(916),s=n(21),c=n(10),d=n(36),l=n(79),u=n("odsp.util_517"),f=n(1555),p=u.x9.isActivated("23DCF7B8-CE78-43EA-8F10-7B5CD47411D5","05/04/2023","return retriedWithGroupReplaceContext as part of listItemResponse"),m=u.x9.isActivated("3f7e1f54-43e3-4c37-a5f3-b78fb07ed315","7/12/22","read groupString from postDataContext when listContext group is empty"),_=u.x9.isActivated("57D36B88-1733-4C98-82C5-4BE3D5153BD5"),h=u.x9.isActivated("41F73C52-686A-41D2-B557-301E5EE25594"),b=function(e){function t(t,n){void 0===n&&(n={});var a=t.pageContext,i=t.normalizeErrors,r=t.noRedirect,o=n.tokenProvider;return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:a,normalizeErrors:i,noRedirect:r,tokenProvider:o})||this}return(0,a.e2)(t,e),t.prototype.getItem=function(t,n,a,i,r,o){var c=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var d=function(){return t.remoteItem?c._getRemoteItemPostData():c.getAdditionalPostData(t.postDataContext,n,t.pageSize)};return(this.getUrlAsync?this.getUrlAsync(n,t):s.c.resolve(void 0)).then(function(l){var u=function(u){return e.prototype.getData.call(c,l?function(){return l}:function(){return c.getUrl(n,t)},function(e,t){return c._parseResponse(e,a.qosEvent,t,u)},a.qosName,d,"POST",c._getListRequestHeaders(t,n,a),void 0,void 0,t.noRedirect,void 0,function(e){var t=c._telemetryHandler(e);return i&&i(t.eventData),t},void 0,t.authToken,void 0,r,o).then(function(e){return e},function(e){return c._errorHandler(a.qosName,e),s.c.reject(e)})};return u().then(function(e){return e},function(e){var n,a;return-1!==(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPQueryThrottledException"))?((null===(a=t.postDataContext)||void 0===a?void 0:a.groupReplace)||(t.postDataContext.groupReplace=!0),_||!h&&t.pageSize||(t.pageSize=30),u(!0)):s.c.reject(e)})})},t.prototype.getUrl=function(e,t){var n,a=t&&t.postDataContext;if(void 0!==(null==t?void 0:t.webAbsoluteUrl)||void 0!==(null==t?void 0:t.listFullUrl)){var r,o=this._isSpecifiedItemRequest(e);r=a&&a.groupReplace?e.requestToken:e.group?void 0:e.requestToken;var s=void 0;!e.group||!this._isExpandingGroup(e.group.groupString)||a&&a.groupReplace?m||!t.group||!this._isExpandingGroup(t.group.groupString)||a&&a.groupReplace||(s=t.group.groupString):s=e.group.groupString;var c={webAbsoluteUrl:t.webAbsoluteUrl||"",listFullUrl:t.listFullUrl||"",rootFolder:t.remoteItem?void 0:e.folderPath,pageToken:r,sortField:!o&&e.sortField?e.sortField:void 0,sortDir:!o&&e.sortField?"false"===e.isAscending?"Desc":"Asc":void 0,filterParams:o||t.ignoreFilterParams?void 0:e.filterParams,viewId:o?void 0:e.viewIdForRequest,viewPath:o?void 0:e.viewPathForRequest,groupString:s,searchTerm:e.searchTerm,inplaceSearchMultiLineFieldQuery:e.inplaceSearchMultiLineFieldQuery,enableModernListSchemas:(null==t?void 0:t.enableModernListSchemas)||!0,spPageFallbackWebAbsoluteUrl:this._pageContext.webAbsoluteUrl};return(0,f.b)(c)}return n={webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId,authToken:null==t?void 0:t.authToken,inplaceSearchMultiLineFieldQuery:e.inplaceSearchMultiLineFieldQuery,enableModernListSchemas:null==t?void 0:t.enableModernListSchemas},u.x9.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(n.isPrefetchPageContext=e.listId&&!this._pageContext.listUrl),this._isSpecifiedItemRequest(e)?n.viewId=e.viewIdForRequest:((!e.viewXmlForRequest||a&&a.isOnePage)&&e.viewIdForRequest!==l.a.Empty&&(n.view=e.viewIdForRequest),!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest),t&&t.ignoreFilterParams||(n.filterParams=e.filterParams),e.sortField&&(n.sortField=e.sortField,n.sortDir="false"===e.isAscending?"Desc":"Asc"),a&&a.groupReplace?n.requestToken=this._isExpandingGroup(n.groupString)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken,!e.group||!this._isExpandingGroup(e.group.groupString)||a&&a.groupReplace?m||!t.group||!this._isExpandingGroup(t.group.groupString)||a&&a.groupReplace||(n.groupString=t.group.groupString):n.groupString=e.group.groupString,a&&a.webId&&(n.webId=a.webId)),i.b(n)},t.prototype.getAdditionalPostData=function(e,t,n){return r.b(e,t,n)},t.prototype.needsRequestDigest=function(e){return!!u.x9.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===e.toLowerCase().indexOf("/renderlistdataasstream?")},t.prototype._getListRequestHeaders=function(e,t,n){var a=i.d(t,e.postDataContext);return n&&n.application&&(a.Application=n.application,a.Scenario="ViewList",a.ScenarioType="AUO"),e.setServiceWorkerCoalesceHeader&&(a["X-Service-Worker-Prefetch-And-Coalesce"]="true"),a["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst",a},t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})},t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0},t.prototype._isExpandingGroup=function(e){return!!e&&"__next__"!==e},t.prototype._parseResponse=function(e,t,n,a){var i=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,i,a,n.getSourceUrl().includes("http://localhost"))}catch(r){if("{}"!==e.substring(0,2))throw t.end({resultType:c.b.Failure,resultCode:"BadJSON"}),r;return this._getListItemResponse(e.substring(2),i,a,n.getSourceUrl().includes("http://localhost"))}},t.prototype._getListItemResponse=function(e,t,n,a){var i;return i=JSON.parse(e),"ServiceWorker-FromCache"===t&&(i.isFromServiceWorkerCache=!0),!p&&n&&(i.retriedWithGroupReplaceContext=!0),i.isFromNucleus=a,i},t.prototype._telemetryHandler=function(e){var t=e.errorData,n=(0,a.q5)({},e.eventData);if(t){var i=void 0,r=t.code?t.code:"";return r.indexOf("2147024860")>-1?r="ListViewTreshold":r.indexOf("2147024749")>-1?r="LookupColumnTreshold":r.indexOf("2147024809")>-1&&r.indexOf("requestUrl")>-1?r="RequestURLFailure":r.indexOf("2147024809")>-1&&r.indexOf("range")>-1?r="RangeError":r.indexOf("2147024809")>-1&&r.indexOf("view")>-1?r="InvalidView":r.indexOf("2130575340")>-1&&r.indexOf("field")>-1?r="FieldTypesNotInstalledProperly":r.indexOf("2146232832")>-1?(r="DefaultDoclibNotFound",500===t.status&&(i=!1,n.resultType=c.b.ExpectedFailure)):r.indexOf("2147024895")>-1?(r="PrefetchWebMismatch",500===t.status&&(i=!1,n.resultType=c.b.ExpectedFailure)):r=n.resultCode,n.resultCode=r,{canRetry:i,eventData:n}}return{eventData:n}},t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?d.a.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&d.a.logData({name:e+".LookupColumnTreshold"})},t}(o.b)}
}]),define("shared-split-bundle~eb6371d1",[],{});